# backend/.env - Dynamic Four-Section Configuration

# ========================================
# 1. ENVIRONMENT CONTROL
# ========================================
# Set to 'neon' for cloud database or 'local' for Docker postgres
USE_DATABASE=neon

# Quick switch helper (change this line to switch databases instantly)
# ACTIVE_ENV=neon  # or 'local'

# ========================================
# 2. NEON DATABASE CONFIGURATION
# ========================================
# NEON DATABASE CONFIGURATION
NEON_DB_HOST=ep-shiny-union-a1yt74qd-pooler.ap-southeast-1.aws.neon.tech
NEON_DB_NAME=neondb
NEON_DB_USER=neondb_owner
NEON_DB_PASSWORD=npg_f7XlIPZeWG1y
NEON_DB_PORT=5432
DATABASE_URL='postgresql://neondb_owner:npg_f7XlIPZeWG1y@ep-shiny-union-a1yt74qd-pooler.ap-southeast-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require'
# 3. LOCAL DATABASE CONFIGURATION
# ========================================
LOCAL_DB_HOST=localhost
LOCAL_DB_NAME=saas_aice
LOCAL_DB_USER=saas_user
LOCAL_DB_PASSWORD=saas_password123
LOCAL_DB_PORT=5432
LOCAL_DATABASE_URL=postgresql://${LOCAL_DB_USER}:${LOCAL_DB_PASSWORD}@${LOCAL_DB_HOST}:${LOCAL_DB_PORT}/${LOCAL_DB_NAME}

# ========================================
# 4. ACTIVE DATABASE CONFIGURATION
# ========================================
# Django reads these variables (currently set to NEON)
DB_ENGINE=django.db.backends.postgresql
DB_NAME=neondb
DB_USER=neondb_owner
DB_PASSWORD=npg_f7XlIPZeWG1y
DB_HOST=ep-shiny-union-a1yt74qd-pooler.ap-southeast-1.aws.neon.tech
DB_PORT=5432
DATABASE_URL='postgresql://neondb_owner:npg_f7XlIPZeWG1y@ep-shiny-union-a1yt74qd-pooler.ap-southeast-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require'

# DATABASE_URL takes precedence over individual DB settings
DATABASE_URL=${NEON_DATABASE_URL}

# DB_HOST=ep-winter-sea-af60qcc3.c-2.us-west-2.aws.neon.tech
# DB_NAME=neondb
# DB_USER=neondb_owner
# DB_PASSWORD=npg_6RBNnq1fQjHF
# DB_PORT=5432


# === SWITCHING INSTRUCTIONS ===
# TO SWITCH TO LOCAL DATABASE:
# 1. Change: DB_HOST=${LOCAL_DB_HOST}
# 2. Change: DB_NAME=${LOCAL_DB_NAME}
# 3. Change: DB_USER=${LOCAL_DB_USER}
# 4. Change: DB_PASSWORD=${LOCAL_DB_PASSWORD}
# 5. Change: DATABASE_URL=${LOCAL_DATABASE_URL}
# 6. Update: USE_DATABASE=local

# === SWITCHING INSTRUCTIONS ===
# # Make script executable
# chmod +x scripts/switch-database.sh

# # Switch to Neon
# ./scripts/switch-database.sh neon

# # Switch to Local
# ./scripts/switch-database.sh local

# # Check current database
# ./scripts/switch-database.sh

# ========================================
# REDIS CONFIGURATION
# ========================================
REDIS_PASSWORD=redis_password123
REDIS_PORT=6379
REDIS_HOST=localhost  # Docker overrides to 'redis'

# Redis URLs
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/0
CELERY_BROKER_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/0
CELERY_RESULT_BACKEND=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/0

# ========================================
# DJANGO CORE CONFIGURATION
# ========================================
SECRET_KEY = "django-insecure-f-=zsmk#xqt#z-)!akm7d8gbug8b3gg6_e1a!#*(oqtjl36a1h"
DEBUG=True
ALLOWED_HOSTS=localhost,127.0.0.1,*.lvh.me
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000,http://lvh.me:3000

# ========================================
# EMAIL CONFIGURATION
# ========================================
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=localhost  # Docker overrides to 'mailhog' for testing
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_USE_SSL=False
EMAIL_HOST_USER=
EMAIL_HOST_PASSWORD=

# For development console output (alternative)
# EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend

# ========================================
# CELERY CONFIGURATION
# ========================================
CELERY_TASK_ALWAYS_EAGER=False
CELERY_TASK_EAGER_PROPAGATES=True
CELERY_ACCEPT_CONTENT=json
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_TIMEZONE=UTC

# ========================================
# MONITORING CONFIGURATION
# ========================================
FLOWER_USER=admin
FLOWER_PASSWORD=admin123
FLOWER_PORT=5555

# ========================================
# MULTI-TENANT CONFIGURATION
# ========================================
DEFAULT_TENANT_DOMAIN=lvh.me
TENANT_SUBFOLDER_PREFIX=
TENANT_MODEL=core.Tenant
TENANT_DOMAIN_MODEL=core.Domain

# Tenant database settings
TENANT_CREATION_FAKES_MIGRATIONS=True
SHARED_APPS=django_tenants,apps.tenants,apps.authentication
TENANT_APPS=apps.core,apps.dashboard,apps.api

# ========================================
# FRONTEND CONFIGURATION
# ========================================
NEXT_PUBLIC_API_URL=http://localhost:8000/api
NEXT_PUBLIC_BASE_URL=http://localhost:3000
FRONTEND_URL=http://localhost:3000

# ========================================
# FILE STORAGE CONFIGURATION
# ========================================
MEDIA_URL=/media/
MEDIA_ROOT=media/
STATIC_URL=/static/
STATIC_ROOT=static/

# Cloud storage (uncomment if using AWS S3, etc.)
# USE_S3=False
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_STORAGE_BUCKET_NAME=
# AWS_S3_REGION_NAME=

# ========================================
# SECURITY CONFIGURATION
# ========================================
SECURE_SSL_REDIRECT=False
SECURE_BROWSER_XSS_FILTER=True
SECURE_CONTENT_TYPE_NOSNIFF=True
X_FRAME_OPTIONS=DENY
SECURE_HSTS_SECONDS=0
SECURE_HSTS_INCLUDE_SUBDOMAINS=False
SECURE_HSTS_PRELOAD=False

# ========================================
# INTERNATIONALIZATION
# ========================================
USE_TZ=True
TIME_ZONE=UTC
LANGUAGE_CODE=en-us
USE_I18N=True
USE_L10N=True

# ========================================
# LOGGING CONFIGURATION
# ========================================
LOG_LEVEL=DEBUG
DJANGO_LOG_LEVEL=INFO
SQL_LOG_LEVEL=DEBUG

# ========================================
# CACHE CONFIGURATION
# ========================================
CACHE_TTL=300
DEFAULT_CACHE_TIMEOUT=300

# ========================================
# SESSION CONFIGURATION
# ========================================
SESSION_COOKIE_AGE=1800  # 30 minutes
SESSION_SAVE_EVERY_REQUEST=True
SESSION_COOKIE_HTTPONLY=True
SESSION_COOKIE_SECURE=False  # Set to True in production with HTTPS

# ========================================
# DEVELOPMENT TOOLS
# ========================================
DJANGO_EXTENSIONS_ENABLED=True
INTERNAL_IPS=127.0.0.1,localhost

# Debug toolbar (uncomment if using)
# ENABLE_DEBUG_TOOLBAR=True

# ========================================
# API CONFIGURATION
# ========================================
API_RATE_LIMIT=1000/hour
PAGINATION_PAGE_SIZE=20
API_VERSION=v1

# ========================================
# THIRD-PARTY SERVICES
# ========================================
# OpenAI (uncomment and add your key)
# OPENAI_API_KEY=your-openai-api-key

# Stripe (uncomment and add your keys)
# STRIPE_PUBLIC_KEY=pk_test_...
# STRIPE_SECRET_KEY=sk_test_...
# STRIPE_WEBHOOK_SECRET=whsec_...

# SendGrid (uncomment and add your key)
# SENDGRID_API_KEY=SG.your-sendgrid-api-key

# ========================================
# BACKUP CONFIGURATION
# ========================================
BACKUP_ENABLED=False
BACKUP_STORAGE_PATH=backups/
BACKUP_RETENTION_DAYS=30

# ========================================
# PERFORMANCE SETTINGS
# ========================================
DATABASE_CONN_MAX_AGE=60
DATABASE_POOL_SIZE=20

# ========================================
# ENVIRONMENT INFO (for debugging)
# ========================================
ENVIRONMENT_NAME=development
PROJECT_NAME=SAAS-AICE
PROJECT_VERSION=1.0.0
